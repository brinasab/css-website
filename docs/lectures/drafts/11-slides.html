<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="Sabrina Nardin, Summer 2025">
  <title>css-website – Introduction to R: Lecture 11</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-864c5404f4710dceefb0a9fe440f50a1.css">
  <link rel="stylesheet" href="../style/styles.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Introduction to R: Lecture 11</h1>
  <p class="subtitle">Topics: Writing Loops Part 2</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Sabrina Nardin, Summer 2025 
</div>
</div>
</div>

</section>
<section id="agenda" class="title-slide slide level1 center">
<h1>Agenda</h1>
<div class="agenda-list">
<ol type="1">
<li>Using For Loops with Dataframes</li>
<li>Alternatives to For Loops in R</li>
<li>While Loops</li>
</ol>
</div>
<p><span style="font-size: 0.8em; color: #666;">These slides were last updated on October 01, 2025 </span></p>
</section>

<section>
<section id="using-for-loops-with-dataframes" class="title-slide slide level1 center middle">
<h1>1. Using For Loops with Dataframes</h1>

</section>
<section id="same-task-with-and-without-a-for-loop" class="slide level2 center">
<h2>Same Task: With and Without a For Loop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb1-3"><a></a><span class="fu">data</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
</div>
</section>
<section id="calculate-the-mean-value-of-several-columns-without-a-loop" class="slide level2 center">
<h2>Calculate the mean value of several columns <em>without a loop</em></h2>
<p>We can take the <code>mean()</code> function, and apply it to each column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-2"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_depth =</span> <span class="fu">mean</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-3"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_flipper_length =</span> <span class="fu">mean</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-4"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_body_mass =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--
```r
mean(penguins_clean$bill_length_mm)
mean(penguins_clean$bill_depth_mm)
mean(penguins_clean$flipper_length_mm)
mean(penguins_clean$body_mass_g)
```
-->
<p>This works — but requires a lot of copy/paste! How can we do the same thing with a for loop?</p>
</section>
<section id="automate-the-same-task-with-a-loop" class="slide level2 center">
<h2>Automate the same task <em>with a loop</em></h2>
<p>First, initialize an empty vector to store results. Second, use a for loop to calculate the mean of each (numeric) column of this penguins dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"double"</span>, <span class="at">length =</span> <span class="fu">ncol</span>(penguins))</span>
<span id="cb4-2"><a></a></span>
<span id="cb4-3"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(penguins)) {</span>
<span id="cb4-4"><a></a>  <span class="co">#print(i)</span></span>
<span id="cb4-5"><a></a>  <span class="co">#print(penguins[i])</span></span>
<span id="cb4-6"><a></a>  output[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(penguins[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-7"><a></a>}</span>
<span id="cb4-8"><a></a></span>
<span id="cb4-9"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--

```r
output <- vector(mode = "double", length = ncol(penguins))

for (i in seq_along(penguins)) {
  if (is.numeric(penguins[[i]])) {
    output[i] <- mean(penguins[[i]], na.rm = TRUE)
  }
}

output
```
-->
<!-- 

### Let's unpack this example: open the **demo.Rmd** from today's class materials!

### Benefits of preallocation

This explains why we are pre-allocating in the first place, and why we do so with a vector:
having an object that is already of the same length of the output, where we are just plugging in  individual values increases speed, rather the more naive approach in which we store reuslts using an  mpty vector or an empty other object (e.g. a dataframe) of length zero, and then append or add on each of the values as we calculate them

For example, let's take this mpg data (built in dataframe in R about auto, we do not really care about the content of the data); here what we are doing is creating duplicates of that dataframe 100 times and we are then putting them together into a single data frame. 

Without preallocation: we can create an empty dataframe (here with the tibble function), iterate over 100 times, take this empty dataframe and combine the rows of it with the rows of the original dataframe, and replace the original object with the new copy and save in output (so we are appending 100 rows every time we iterate!) 

If we do proper preallocation: we create a list of 100 empty elements, every time we store the results in the list, then we use the bind_rows() functions at the end

The first approach does not preallocate by creating an empty space to store the output, the second does. See the difference in time of execution. From 80 milliseconds to less than 3. So you can see how inefficient is not to allocate since most of our data will have more than 100 rows!

.panelset[
.panel[.panel-name[Code]
```r
# no preallocation
mpg_no_preall <- tibble()
for(i in 1:100){
  mpg_no_preall <- bind_rows(mpg_no_preall, mpg)
}

# with preallocation using a list
mpg_preall <- vector(mode = "list", length = 100)
for(i in 1:100){
  mpg_preall[[i]] <- mpg
}
mpg_preall <- bind_rows(mpg_preall)
```
]

.panel[.panel-name[Plot]
```r
#| out.width = "70%",
#| echo = FALSE
# load microbenchmark library to time code
library(microbenchmark)
# bind together 100 copies of mpg
times <- microbenchmark(
  `No preallocation` = {
    mpg_no_preall <- tibble()
    
    for(i in 1:100){
      mpg_no_preall <- bind_rows(mpg_no_preall, mpg)
    }
  },
  `Preallocation` = {
    mpg_preall <- vector(mode = "list", length = 100)
    
    for(i in 1:100){
      mpg_preall[[i]] <- mpg
    }
    
    mpg_preall <- bind_rows(mpg_preall)
  }
)
autoplot(times)
```
]
]
-->
</section></section>
<section>
<section id="alternatives-to-for-loops-in-r" class="title-slide slide level1 center middle">
<h1>2. Alternatives to For Loops in R</h1>

</section>
<section id="why-we-even-learn-loops-in-r" class="slide level2 center">
<h2>Why We Even Learn Loops in R?</h2>
<p>R is a <strong>vectorized language</strong>, so many tasks can and should be done <strong>without writing a for loop</strong>.</p>
<p>Still, understanding loops is important:</p>
<ul>
<li>to build foundational <strong>logic and control flow</strong> skills</li>
<li>for <strong>non-vectorized tasks</strong>, like row-by-row operations</li>
<li>to <strong>debug</strong> more complex workflows</li>
</ul>
<!--
> Even if you don’t use loops every day, knowing how they work will strengthen your ability to write efficient and readable R code.
-->
</section>
<section id="three-main-alternatives-to-for-loops-in-r" class="slide level2 center">
<h2>Three Main Alternatives to For Loops in R</h2>
<p>When working with dataframes, R provides the following alternatives that are <strong>often better</strong> than writing a for loop:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Function Family</th>
<th>Package</th>
<th>Best Used For</th>
<th>Docs / Link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>map_*()</code></td>
<td><code>purrr</code></td>
<td>Applying functions to elements of lists or columns</td>
<td><a href="https://purrr.tidyverse.org/reference/map.html">map docs</a></td>
</tr>
<tr class="even">
<td><code>across()</code></td>
<td><code>dplyr</code></td>
<td>Applying the same function to multiple columns inside <code>mutate()</code> or <code>summarize()</code></td>
<td><a href="https://dplyr.tidyverse.org/reference/across.html">across docs</a></td>
</tr>
<tr class="odd">
<td><code>*apply()</code></td>
<td>base R</td>
<td>Row/column-wise operations on matrices or data frames</td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/apply.html">apply docs</a></td>
</tr>
</tbody>
</table>
<p>The asterisk <code>*</code> is a placeholder for a family of related functions (e.g., <code>map_dbl()</code>, <code>map_chr()</code>, <code>sapply()</code>, etc.)</p>
<!--
1. `map_*()` functions from `purr` <https://purrr.tidyverse.org/reference/map.html>
2. `across()` function from `dplyr` <https://dplyr.tidyverse.org/reference/across.html>
3. `*apply()` functions from base R <https://stat.ethz.ch/R-manual/R-devel/library/base/html/apply.html>

The asterisk `*` is a placeholder indicating a *family* of related functions (e.g., `map_dbl()`, `map_chr()`, `sapply()`, etc.).

- Use the `map_*()` functions from the *purrr* package for flexible iteration  
- Use `across()` with `summarize()` or `mutate()` for column-wise operations  
- Use `apply()` to iterate over rows or columns in a matrix or data frame
-->
</section>
<section id="replacing-for-loops-with-map-functions-in-the-tidyverse" class="slide level2 center">
<h2>1. Replacing for loops with “map()” functions in the tidyverse</h2>
<!-- As we have seen in the slides and practice, we kind of have to write a lot of code for a for loop, for example to calculate a straightforward operation like the mean or median etc. so R gives us a shortcut: map functions which come from the purrr package in R and are much more compact (go to the documentation page)
-->
<p>The so-called “map functions” come from the <code>purr</code> package in R: <a href="https://purrr.tidyverse.org/reference/map.html" class="uri">https://purrr.tidyverse.org/reference/map.html</a></p>
<p><strong>There are several <code>map_*()</code> functions</strong> each creates a different type of output (this is the same idea as in the <code>for loop</code> when we specify the <code>mode</code> of our output vector):</p>
<ul>
<li><code>map()</code> makes a list</li>
<li><code>map_lgl()</code> makes a logical vector</li>
<li><code>map_int()</code> makes an integer vector</li>
<li><code>map_dbl()</code> makes a double vector</li>
<li><code>map_chr()</code> makes a character vector</li>
</ul>
<p>Let’s see a few examples using the <code>penguins</code> data.</p>
</section>
<section id="replacing-for-loops-with-map-functions-in-the-tidyverse-1" class="slide level2 center">
<h2>1. Replacing for loops with “map()” functions in the tidyverse</h2>
<p>Pick the appropriate <code>map()</code> function (there are several!) and specify at least two main arguments:</p>
<ul>
<li>what you are iterating over</li>
<li>what you are calculating</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a></a>  <span class="fu">map_dbl</span>(mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ADD PRACTICE EXERCISE
## 💻 Practice
-->
</section>
<section id="replacing-for-loops-with-across-in-the-tidyverse" class="slide level2 center">
<h2>2. Replacing for loops with “across()” in the tidyverse</h2>
<p><strong>Another popular option to replace a for loop is the <code>across()</code> function from <code>dplyr</code></strong></p>
<p><strong>What it does:</strong> applies the same operation (e.g., mean) to multiple columns at once</p>
<p><strong>Best use:</strong> since it comes from <code>dplyr</code>, it works seamlessly inside <code>dplyr</code> verbs like <code>mutate()</code> and <code>summarize()</code> (these are its favorite verbs to work with!)</p>
</section>
<section id="replacing-for-loops-with-across-in-the-tidyverse-1" class="slide level2 center">
<h2>2. Replacing for loops with “across()” in the tidyverse</h2>
<p>We looked at this example earlier (which calculates the mean of several columns in a data frame) and rewrote it using a for loop. Now we rewrite it again but this time using <code>across()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-2"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_depth =</span> <span class="fu">mean</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-3"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_flipper_length =</span> <span class="fu">mean</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-4"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_body_mass =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="replacing-for-loops-with-across-in-the-tidyverse-2" class="slide level2 center">
<h2>2. Replacing for loops with “across()” in the tidyverse</h2>
<p>Rewrite previous example using <code>across()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a></a>  <span class="fu">summarize</span>(</span>
<span id="cb7-3"><a></a>    <span class="fu">across</span>(</span>
<span id="cb7-4"><a></a>      <span class="at">.cols =</span> <span class="fu">where</span>(is.numeric),           <span class="co"># select columns by type</span></span>
<span id="cb7-5"><a></a>      <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))   <span class="co"># apply mean, skipping NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <code>across()</code> has two main arguments:</p>
<ul>
<li><strong><code>.cols</code></strong>: the columns to operate on. You can select them by position, name, or type (in this example, by type using <code>where(is.numeric)</code>).</li>
<li><strong><code>.fns</code></strong>: the function, or list of functions, to apply to each column (in this example, we use <code>mean()</code> and <code>.x</code> is a placeholder for the current column being processed)</li>
</ul>
<p>You can omit <code>.cols</code> and <code>.fns</code> if you pass the arguments in the correct order.</p>
</section>
<section id="replacing-for-loops-with-across-in-the-tidyverse-3" class="slide level2 center">
<h2>2. Replacing for loops with “across()” in the tidyverse</h2>
<p>Add names to the newly computed means:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a></a>  <span class="fu">summarize</span>(</span>
<span id="cb8-3"><a></a>    <span class="fu">across</span>(</span>
<span id="cb8-4"><a></a>      <span class="at">.cols =</span> <span class="fu">where</span>(is.numeric),                   </span>
<span id="cb8-5"><a></a>      <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),             </span>
<span id="cb8-6"><a></a>      <span class="at">.names =</span> <span class="st">"avg_{.col}"</span>                   </span>
<span id="cb8-7"><a></a>    )</span>
<span id="cb8-8"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div title="What does `&quot;avg_{.col}&quot;` mean?">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What does <code>"avg_{.col}"</code> mean?</strong></p>
</div>
<div class="callout-content">
<ul>
<li><code>"avg_"</code> is a literal prefix that will be added to each new column name.<br>
</li>
<li><code>{.col}</code> is a placeholder that will be replaced with the original column name.</li>
</ul>
<p>So if you’re applying <code>mean()</code> to a column named <code>bill_length_mm</code>, the result will be named <code>avg_bill_length_mm</code></p>
</div>
</div>
</div>
</div>
<!-- FOR CSS CLASS: ADD THOSE EXAMPLES OR MORE + A PRACTICE EXERCISE

## More examples using the [`worldbank` data](https://data.worldbank.org/)


::: {.cell}
::: {.cell-output .cell-output-stdout}

```
# A tibble: 78 × 14
   iso3c date  iso2c country   perc_energy_fosfuel rnd_gdpshare
   <chr> <chr> <chr> <chr>                   <dbl>        <dbl>
 1 ARG   2005  AR    Argentina                89.1        0.379
 2 ARG   2006  AR    Argentina                88.7        0.400
 3 ARG   2007  AR    Argentina                89.2        0.402
 4 ARG   2008  AR    Argentina                90.7        0.421
 5 ARG   2009  AR    Argentina                89.6        0.519
 6 ARG   2010  AR    Argentina                89.5        0.518
 7 ARG   2011  AR    Argentina                88.9        0.537
 8 ARG   2012  AR    Argentina                89.0        0.609
 9 ARG   2013  AR    Argentina                89.0        0.612
10 ARG   2014  AR    Argentina                87.7        0.613
# ℹ 68 more rows
# ℹ 8 more variables: percgni_adj_gross_savings <dbl>,
#   real_netinc_percap <dbl>, gdp_capita <dbl>, top10perc_incshare <dbl>,
#   employment_ratio <dbl>, life_exp <dbl>, pop_growth <dbl>, pop <dbl>
```


:::
:::


---

### `summarize()`, `across()`, and `where()`


::: {.cell}
::: {.cell-output .cell-output-stdout}

```
# A tibble: 6 × 11
  country        perc_energy_fosfuel rnd_gdpshare percgni_adj_gross_savings
  <chr>                        <dbl>        <dbl>                     <dbl>
1 Argentina                     89.1       0.501                       17.5
2 China                         87.6       1.67                        48.3
3 Indonesia                     65.3       0.0841                      30.5
4 Norway                        58.9       1.60                        37.2
5 United Kingdom                86.3       1.68                        13.5
6 United States                 84.2       2.69                        17.6
# ℹ 7 more variables: real_netinc_percap <dbl>, gdp_capita <dbl>,
#   top10perc_incshare <dbl>, employment_ratio <dbl>, life_exp <dbl>,
#   pop_growth <dbl>, pop <dbl>
```


:::
:::



::: {.cell}
::: {.cell-output .cell-output-stdout}

```
# A tibble: 6 × 3
  country        perc_energy_fosfuel percgni_adj_gross_savings
  <chr>                        <dbl>                     <dbl>
1 Argentina                     89.1                      17.5
2 China                         87.6                      48.3
3 Indonesia                     65.3                      30.5
4 Norway                        58.9                      37.2
5 United Kingdom                86.3                      13.5
6 United States                 84.2                      17.6
```


:::
:::



---

### `across()` and `filter()`

To use `across()` with `filter()`, we need an extra step: `if_any()` or `if_all()`


::: {.cell}

```{.r .cell-code}
# if_any() keeps rows where the predicate is true for at least one column
worldbank %>%
  filter(if_any(everything(), ~ !is.na(.x)))
```
:::



::: {.cell}

```{.r .cell-code}
# if_all() keeps rows where the predicate is true for all selected columns
worldbank %>%
  filter(if_all(everything(), ~ !is.na(.x)))
```
:::


-->
</section>
<section id="replacing-for-loops-with-apply-functions-in-base-r" class="slide level2 center">
<h2>3. Replacing for loops with “apply()” functions in base R</h2>
<p><strong>Finally, a third option to replace a for loop in R is using one of the <code>apply()</code> functions from base R</strong></p>
<p><strong>What it does:</strong> applies the same operation (e.g., mean) to multiple columns at once</p>
<p><strong>Best use:</strong> when working outside tidyverse verbs (this is from base R!) and can be applied across rows or columns (most common)</p>
</section>
<section id="replacing-for-loops-with-apply-functions-in-base-r-1" class="slide level2 center">
<h2>3. Replacing for loops with “apply()” functions in base R</h2>
<p>We looked at this example earlier (which calculates the mean of several columns in a data frame) and rewrote it using a <code>for</code> loop. Now we rewrite it again but this time using <code>apply()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-2"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_depth =</span> <span class="fu">mean</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-3"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_flipper_length =</span> <span class="fu">mean</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-4"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_body_mass =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="replacing-for-loops-with-apply-functions-in-base-r-2" class="slide level2 center">
<h2>3. Replacing for loops with “apply()” functions in base R</h2>
<p>Rewrite previous example using <code>apply()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="co"># manually select only numeric column using base R syntax</span></span>
<span id="cb10-2"><a></a>penguins_numeric <span class="ot">&lt;-</span> penguins[ , <span class="fu">c</span>(<span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span>, </span>
<span id="cb10-3"><a></a>                                  <span class="st">"flipper_length_mm"</span>, <span class="st">"body_mass_g"</span>)]</span>
<span id="cb10-4"><a></a></span>
<span id="cb10-5"><a></a><span class="co"># apply mean to these columns</span></span>
<span id="cb10-6"><a></a><span class="fu">apply</span>(penguins_numeric, <span class="dv">2</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note the <code>2</code> stays for <code>MARGIN = 2</code> (apply on the columns). If you write 1 it means rows. Type <code>?apply</code> in your Console for more info.</p>
</section>
<section id="replacing-for-loops-with-apply-functions-in-base-r-3" class="slide level2 center">
<h2>3. Replacing for loops with “apply()” functions in base R</h2>
<p>The <code>apply()</code> is a family meaning there are several similar apply function you can use:</p>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 28%">
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Use Case</th>
<th>Input Type</th>
<th>Output Type</th>
<th>Why Use It</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>apply()</code></td>
<td>Apply a function to rows or columns</td>
<td>Matrix, data frame</td>
<td>Vector or matrix</td>
<td>For row/column-wise operations</td>
</tr>
<tr class="even">
<td><code>lapply()</code></td>
<td>Apply a function to each element</td>
<td>List, data frame</td>
<td>List</td>
<td>Keeps outputs as list (safe, flexible)</td>
</tr>
<tr class="odd">
<td><code>sapply()</code></td>
<td>Like <code>lapply()</code> but simplifies output</td>
<td>List, data frame</td>
<td>Vector or matrix</td>
<td>Shorter output, easier to read</td>
</tr>
<tr class="even">
<td><code>vapply()</code></td>
<td>Like <code>sapply()</code>, but type-safe</td>
<td>List, data frame</td>
<td>Vector or matrix</td>
<td>Safer than <code>sapply()</code>—explicit type check</td>
</tr>
</tbody>
</table>
</section>
<section id="replacing-for-loops-with-apply-functions-in-base-r-4" class="slide level2 center">
<h2>3. Replacing for loops with “apply()” functions in base R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="co"># Use numeric columns from penguins dataset</span></span>
<span id="cb11-2"><a></a>num_data <span class="ot">&lt;-</span> penguins[ , <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb11-3"><a></a></span>
<span id="cb11-4"><a></a><span class="co"># apply(): function across columns (MARGIN = 2)</span></span>
<span id="cb11-5"><a></a><span class="fu">apply</span>(num_data, <span class="dv">2</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-6"><a></a></span>
<span id="cb11-7"><a></a><span class="co"># lapply(): list output</span></span>
<span id="cb11-8"><a></a><span class="fu">lapply</span>(num_data, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-9"><a></a></span>
<span id="cb11-10"><a></a><span class="co"># sapply(): simplified vector output</span></span>
<span id="cb11-11"><a></a><span class="fu">sapply</span>(num_data, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-12"><a></a></span>
<span id="cb11-13"><a></a><span class="co"># vapply(): safe version of sapply()</span></span>
<span id="cb11-14"><a></a><span class="fu">vapply</span>(num_data, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>apply()</code> works best with matrix-like structures</li>
<li><code>lapply()</code> is list-safe; <code>sapply()</code> is more concise</li>
<li><code>vapply()</code> avoids surprises by enforcing output type (here: return a single numeric value)</li>
</ul>
</section></section>
<section>
<section id="while-loops" class="title-slide slide level1 center middle">
<h1>3. While Loops</h1>

</section>
<section id="definition-of-while-loops" class="slide level2 center">
<h2>Definition of While Loops</h2>
<p>We focused on “for loops” because they are the most common, but R, and many other programming languages, also supports “while loops”</p>
<p><strong>How while loops works:</strong></p>
<ul>
<li>Evaluate a condition</li>
<li>If the condition is <code>TRUE</code>, run the loop body</li>
<li>Start over: re-evaluate the condition</li>
<li>Repeat until the condition is <code>FALSE</code> (then the while loop is over)</li>
</ul>
</section>
<section id="while-loop-syntax" class="slide level2 center">
<h2>While Loop Syntax</h2>
<p>Syntax:</p>
<pre><code>while (condition to be evaluated) {
  statement(s)
}</code></pre>
<p>Example:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-2"><a></a></span>
<span id="cb13-3"><a></a><span class="cf">while</span>(counter <span class="sc">&lt;=</span> <span class="dv">4</span>) {</span>
<span id="cb13-4"><a></a>  <span class="fu">print</span>(counter)</span>
<span id="cb13-5"><a></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-6"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- 
set the counter outside the loop, usually to 1
set a condition to be evaluated: here the condition says the counter has to be smaller or equal to 4
if the condition is TRUE, the loop is executed, here we only print(counter)
thus the first time it prints 1
but if we leave it as it is (without the last line of code), the while loops will keep going infinitely: we need a way to break the loop
thus we increment our counter inside the loop by redefining it as counter + 1
-->
</section>
<section id="while-loop-examples" class="slide level2 center">
<h2>While Loop Examples</h2>
<p>Take the previous code, but this time print <code>counter</code> also at the end:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-2"><a></a></span>
<span id="cb14-3"><a></a><span class="cf">while</span>(counter <span class="sc">&lt;=</span> <span class="dv">3</span>) {</span>
<span id="cb14-4"><a></a>  <span class="fu">print</span>(counter)</span>
<span id="cb14-5"><a></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-6"><a></a>  <span class="fu">print</span>(counter)</span>
<span id="cb14-7"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Why are the results different from the previous code?</p>
</section>
<section id="while-loop-examples-1" class="slide level2 center">
<h2>While Loop Examples</h2>
<p>Take the previous code, but this time we do not increment our <code>counter</code> variable.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-2"><a></a><span class="cf">while</span>(counter <span class="sc">&lt;</span> <span class="dv">3</span>){</span>
<span id="cb15-3"><a></a>  <span class="fu">print</span>(counter)</span>
<span id="cb15-4"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What is the output of this code?</p>
</section>
<section id="while-loop-examples-2" class="slide level2 center">
<h2>While Loop Examples</h2>
<p>What is the output of this code?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-2"><a></a><span class="cf">while</span>(counter <span class="sc">&lt;</span> <span class="dv">4</span>){</span>
<span id="cb16-3"><a></a>  <span class="fu">print</span>(counter)</span>
<span id="cb16-4"><a></a>  multiply <span class="ot">&lt;-</span> counter <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb16-5"><a></a>  <span class="fu">print</span>(multiply)</span>
<span id="cb16-6"><a></a>  counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb16-7"><a></a>  <span class="fu">print</span>(counter)</span>
<span id="cb16-8"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="while-loop-uses" class="slide level2 center">
<h2>While Loop Uses</h2>
<p>While Loops are useful <strong>when you don’t know in advance how many times to iterate</strong> — you want the loop to continue <strong>until a condition is met</strong>.</p>
<h4 id="example-use-cases">Example use cases:</h4>
<ul>
<li>Keep looping until you get <strong>three heads in a row</strong> from random coin flips<br>
</li>
<li>Keep accepting user input <strong>until you reach a target number of responses</strong></li>
</ul>
<p>While loops require a <strong>“count variable”</strong> to be set outside the loop.</p>
<p>While loops are important but less common than for loops especially for the types of tasks we do in this course. For this reason, we don’t cover them in-depth.</p>
<!--
## Recap: What We Learned Today
-->
</section>
<section id="to-print-these-slides-as-pdf" class="slide level2 center">
<h2>To print these slides as pdf</h2>
<p>Click on the icon bottom-right corner &gt; Tools &gt; PDF Export Mode &gt; Print as a Pdf</p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>