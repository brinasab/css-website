<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="Sabrina Nardin, Fall 2025">
  <title>css-website ‚Äì Computing for the Social Sciences: Lecture 12</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-864c5404f4710dceefb0a9fe440f50a1.css">
  <link rel="stylesheet" href="../style/styles.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Computing for the Social Sciences: Lecture 12</h1>
  <p class="subtitle">Topics: Writing For Loops</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Sabrina Nardin, Fall 2025 
</div>
</div>
</div>

</section>
<section id="agenda" class="title-slide slide level1 center">
<h1>Agenda</h1>
<div class="agenda-list">
<ol type="1">
<li>For Loops</li>
<li>Tracking and Saving For Loops Output</li>
<li>Looping Over Elements vs.&nbsp;Indexes</li>
<li>Using For Loops with Dataframes</li>
</ol>
</div>
<p><span style="font-size: 0.8em; color: #666;"> <em>Slides last updated on <strong>November 5, 2025</strong>. Slides authored by Sabrina Nardin. AI used to polish slides style and fix typos.</em> </span></p>
<!-- NOTES TO IMPROVE CURRENT LOOP SLIDES

Add a few slides that show the differences of looping over indexes or looping over elements and 
teach that concept form the slides; then leave the in-class demo code with the key and let students explore it in team and go around for questions. Total time 10 min slides and 10 go over code + 5 review

In the demo for loop: add code on data structure, e.g. show how to access columns of a df and their elements with the double and single square brackets 

Show difference of accessing single column in a df (that is a vector so use []) or elements of columns for which you need to use [[]]

When you teach for loops add the break and continue statements (currently not in slides!)

-->
</section>

<section>
<section id="for-loops" class="title-slide slide level1 center middle">
<h1>1. For Loops</h1>

</section>
<section class="slide level2 center">

<h3 id="what-are-control-structures">What Are Control Structures?</h3>
<p>Control structures let us write code that can:</p>
<ul>
<li><p><strong>Make decisions</strong> ‚Üí with <strong>conditional statements</strong> like <code>if</code>, <code>if...else</code>, etc.</p></li>
<li><p><strong>Repeat actions</strong> ‚Üí with <strong>loops</strong> like <code>for</code>, <code>while</code> (today‚Äôs topic)</p></li>
</ul>
<p>Conditional statements and loops (e.g., control structures) let our code responds dynamically to different situations.</p>
<p>Today we focus on loops, and specifically on ‚ÄúFor loops‚Äù!</p>
</section>
<section id="definition-of-for-loops" class="slide level2 center">
<h2>Definition of For Loops</h2>
<p>For loops let you repeat an action for each element of an object, usually a vector or list. They‚Äôre a common way to iterate in many programming languages.</p>
<p>Syntax:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="cf">for</span> (item <span class="cf">in</span> sequence of items) {</span>
<span id="cb1-2"><a></a>  action to be repeated <span class="cf">for</span> each item   </span>
<span id="cb1-3"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="cf">for</span> (item <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb2-2"><a></a>  <span class="fu">print</span>(item)</span>
<span id="cb2-3"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What‚Äôs the repeated action here? How many times? What‚Äôs item?</p>
<!--
Let's break this code down:

- The repeated action here is simple: `print(item)`

- `item` is a placeholder: its value changes with each loop iteration

- the number of times the statement block repeats depends on the number of items in the sequence ‚Äî in this example: three items, thus three times
-->
</section>
<section id="nested-for-loops" class="slide level2 center">
<h2>Nested For Loops</h2>
<p>For loops can be nested, so the outer loop controls how many times the entire inner loop runs from start to finish:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb3-2"><a></a>  <span class="fu">print</span>(i)</span>
<span id="cb3-3"><a></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"squirrel"</span>, <span class="st">"rabbit"</span>)) {</span>
<span id="cb3-4"><a></a>    <span class="fu">print</span>(j)</span>
<span id="cb3-5"><a></a>  }</span>
<span id="cb3-6"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What‚Äôs going on here?</p>
<ul>
<li><p>The outer loop runs 3 times</p></li>
<li><p>For each execution of the outer loop, the inner loop runs 4 times</p></li>
</ul>
<!--
for (i in c(1,2,3)) {
  print(i)
  for (j in c("cat", "dog", "squirrel", "rabbit")) {
    print(j)
     for (x in c(10:11))
        print(x)
  }
}
-->
</section></section>
<section>
<section id="tracking-and-saving-for-loops-output" class="title-slide slide level1 center middle">
<h1>2. Tracking and Saving For Loops Output</h1>

</section>
<section id="tracing-execution-in-a-for-loop" class="slide level2 center">
<h2>Tracing Execution in a For Loop</h2>
<p>Observe this code. What does it output in each run?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) {</span>
<span id="cb4-2"><a></a>  <span class="fu">print</span>(i)</span>
<span id="cb4-3"><a></a>  <span class="fu">print</span>(<span class="st">"Hello"</span>)</span>
<span id="cb4-4"><a></a>  my_sum <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">+</span> i</span>
<span id="cb4-5"><a></a>  <span class="fu">print</span>(my_sum)</span>
<span id="cb4-6"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"End of Loop"</span>, i))</span>
<span id="cb4-7"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="fragment">
<h4 id="change-the-code-and-predict-what-happens">üíª Change the code and predict what happens:</h4>
<ul>
<li>Add another <code>print(my_sum)</code> before the line <code>my_sum &lt;- 100 + i</code>. <em>Clear the environment and run the code: What happens?</em></li>
<li>Remove that line, and add these two lines <code>my_sum &lt;- my_sum + i</code> and <code>print(my_sum)</code> right after the last <code>print(my_sum)</code>. <em>Clear the environment and run the code: What happens?</em></li>
</ul>
<!-- Learning goals, in order by bullet point:
- Accessing a variable before assignment
- Reassigning a value
- Using a variable in its own reassignment
- Explore
-->
</div>
<p><br></p>
</section>
<section id="tracing-execution-in-a-for-loop-1" class="slide level2 center">
<h2>Tracing Execution in a For Loop</h2>
<p>This is similar to the previous code, BUT defines <code>my_sum</code> outside the loop and updates it inside with <code>my_sum &lt;- my_sum + i</code></p>
<p>Clear the environment and run the code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-2"><a></a></span>
<span id="cb5-3"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) {</span>
<span id="cb5-4"><a></a>  <span class="fu">print</span>(i)</span>
<span id="cb5-5"><a></a>  <span class="fu">print</span>(<span class="st">"Hello"</span>)</span>
<span id="cb5-6"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> i</span>
<span id="cb5-7"><a></a>  <span class="fu">print</span>(my_sum)</span>
<span id="cb5-8"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"End of Loop"</span>, i))</span>
<span id="cb5-9"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="fragment">
<h4 id="change-the-code-and-predict-what-happens-1">üíª Change the code and predict what happens:</h4>
<ul>
<li>Comment out <code>my_sum &lt;- my_sum + i</code>. <em>Clear the environment and run the code: What happens?</em></li>
<li>Go back the original code, then move <code>my_sum &lt;- 0</code> inside the loop after <code>print("Hello")</code>. <em>Clear the environment and run the code: What happens?</em></li>
</ul>
</div>
<p><br></p>
</section>
<section id="accumulating-a-running-total" class="slide level2 center">
<h2>Accumulating a Running Total</h2>
<p>Loops are very useful for accumulating a running total ‚Äî for example, <strong>when you are adding up scores, votes, or anything else one at a time, and tracking how the total grows with each loop</strong>.</p>
<p>This is the same code as in the previous slide, but with more informative print statements to make each step easier to follow. Clear the environment and run the code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-2"><a></a></span>
<span id="cb6-3"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb6-4"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current i is"</span>, i))</span>
<span id="cb6-5"><a></a>  <span class="fu">print</span>(<span class="st">"Hello"</span>)</span>
<span id="cb6-6"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> i</span>
<span id="cb6-7"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current sum is"</span>, my_sum))</span>
<span id="cb6-8"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"End of Loop"</span>, i))</span>
<span id="cb6-9"><a></a>}</span>
<span id="cb6-10"><a></a></span>
<span id="cb6-11"><a></a>my_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="saving-results-from-a-for-loop" class="slide level2 center">
<h2>Saving Results from a For Loop</h2>
<p>Our previous code printed the updated sum value each time, but only saved the final value! Like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-2"><a></a></span>
<span id="cb7-3"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb7-4"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> i</span>
<span id="cb7-5"><a></a>  <span class="fu">print</span>(my_sum)</span>
<span id="cb7-6"><a></a>}</span>
<span id="cb7-7"><a></a></span>
<span id="cb7-8"><a></a>my_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To save all intermediate sum values, we need to store them in a vector (here <code>output</code>). Like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb8-2"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"integer"</span>, <span class="at">length =</span> <span class="dv">3</span>)  <span class="co"># new!</span></span>
<span id="cb8-3"><a></a></span>
<span id="cb8-4"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb8-5"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> i</span>
<span id="cb8-6"><a></a>  <span class="fu">print</span>(my_sum)</span>
<span id="cb8-7"><a></a>  output[i] <span class="ot">&lt;-</span> my_sum     <span class="co"># new!</span></span>
<span id="cb8-8"><a></a>}</span>
<span id="cb8-9"><a></a></span>
<span id="cb8-10"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="saving-results-from-a-for-loop-1" class="slide level2 center">
<h2>Saving Results from a For Loop</h2>
<p>To save all intermediate sum values, we need to store them in a vector (here <code>output</code>). Like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-2"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"integer"</span>, <span class="at">length =</span> <span class="dv">3</span>)  <span class="co"># new!</span></span>
<span id="cb9-3"><a></a></span>
<span id="cb9-4"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb9-5"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> i</span>
<span id="cb9-6"><a></a>  <span class="fu">print</span>(my_sum)</span>
<span id="cb9-7"><a></a>  output[i] <span class="ot">&lt;-</span> my_sum     <span class="co"># new!</span></span>
<span id="cb9-8"><a></a>}</span>
<span id="cb9-9"><a></a></span>
<span id="cb9-10"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment small-text" title="`output[i] <- my_sum`">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><code>output[i] &lt;- my_sum</code></strong></p>
</div>
<div class="callout-content">
<p>When <code>i = 1</code>, <code>my_sum = 0 + 1 = 1</code> ‚Üí store <code>1</code> in <code>output[1]</code> ‚Üí output becomes: <code>1 0 0</code><br>
When <code>i = 2</code>, <code>my_sum = 1 + 2 = 3</code> ‚Üí store <code>3</code> in <code>output[2]</code> ‚Üí output becomes: <code>1 3 0</code><br>
When <code>i = 3</code>, <code>my_sum = 3 + 3 = 6</code> ‚Üí store <code>6</code> in <code>output[3]</code> ‚Üí output becomes: <code>1 3 6</code></p>
<p>This saves the running total at each position <code>i</code> in the vector output!</p>
</div>
</div>
</div>
</div>
</section>
<section id="saving-results-from-a-for-loop-2" class="slide level2 center">
<h2>Saving Results from a For Loop</h2>
<p><strong>Our current code works but it‚Äôs NOT YET optimal:</strong></p>
<ul>
<li>It only behaves correctly because the looping input vector is exactly <code>c(1, 2, 3)</code></li>
<li>If the values in that vector change, the current code may produce incorrect or unexpected results</li>
</ul>
<p><strong>üíª Try this:</strong></p>
<p>Take the code from the previous slide and change the looping input vector to <code>c(1, 4, 6)</code>. Clear the environment and run the code. Observe what happens to <code>output</code>. Why?</p>
</section>
<section id="saving-results-from-a-for-loop-3" class="slide level2 center">
<h2>Saving Results from a For Loop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-2"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"integer"</span>, <span class="at">length =</span> <span class="dv">3</span>)</span>
<span id="cb10-3"><a></a></span>
<span id="cb10-4"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">6</span>)) {</span>
<span id="cb10-5"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> i</span>
<span id="cb10-6"><a></a>  <span class="fu">print</span>(my_sum)</span>
<span id="cb10-7"><a></a>  output[i] <span class="ot">&lt;-</span> my_sum </span>
<span id="cb10-8"><a></a>}</span>
<span id="cb10-9"><a></a></span>
<span id="cb10-10"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment small" title="What Happens in Each Iteration of this Loop">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What Happens in Each Iteration of this Loop</strong></p>
</div>
<div class="callout-content">
<p>When <code>i = 1</code> ‚Üí <code>my_sum = 0 + 1 = 1</code> ‚Üí store <code>1</code> in <code>output[1]</code> ‚Üí output becomes: <code>1 0 0</code></p>
<p>When <code>i = 4</code> ‚Üí <code>my_sum = 1 + 4 = 5</code> ‚Üí store <code>5</code> in <code>output[4]</code> ‚Üí output becomes: <code>1 0 0 5</code></p>
<p>When <code>i = 6</code> ‚Üí <code>my_sum = 5 + 6 = 11</code> ‚Üí store 11 in <code>output[6]</code> ‚Üí output becomes: <code>1 0 0 5 NA 11</code></p>
<p><strong>This does not look right! Why the output is not [1, 5, 11]?</strong><br>
To see why, we need to understand the difference between looping over elements vs.&nbsp;indexes‚Ä¶</p>
</div>
</div>
</div>
</div>
<!-- R won‚Äôt throw an error if you assign a value to an index beyond a vector‚Äôs original length: it silently extends the vector, which can lead to unexpected results.-->
</section></section>
<section>
<section id="looping-over-elements-vs.-indexes" class="title-slide slide level1 center middle">
<h1>3. Looping Over Elements vs.&nbsp;Indexes</h1>

</section>
<section id="elements-vs.-indexes-why-it-matters" class="slide level2 center">
<h2>Elements vs.&nbsp;Indexes: Why It Matters</h2>
<p>Run these examples and spot the differences:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="co"># Version A: Looping over values/elements</span></span>
<span id="cb11-2"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb11-3"><a></a><span class="cf">for</span> (i <span class="cf">in</span> x) {</span>
<span id="cb11-4"><a></a>  <span class="fu">print</span>(i)        <span class="co"># value</span></span>
<span id="cb11-5"><a></a>}</span>
<span id="cb11-6"><a></a></span>
<span id="cb11-7"><a></a><span class="co"># Version B: Looping over indexes</span></span>
<span id="cb11-8"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb11-9"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb11-10"><a></a>  <span class="fu">print</span>(i)        <span class="co"># index</span></span>
<span id="cb11-11"><a></a>  <span class="fu">print</span>(x[i])     <span class="co"># value at that index</span></span>
<span id="cb11-12"><a></a>}</span>
<span id="cb11-13"><a></a></span>
<span id="cb11-14"><a></a><span class="co"># Same as Version B just another common method</span></span>
<span id="cb11-15"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb11-16"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb11-17"><a></a>  <span class="fu">print</span>(i)</span>
<span id="cb11-18"><a></a>  <span class="fu">print</span>(x[i])</span>
<span id="cb11-19"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment small" title="`i` and `x[i]`">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><code>i</code> and <code>x[i]</code></strong></p>
</div>
<div class="callout-content">
<p><code>i</code> is the loop <strong>index</strong> or ‚Äúcounter‚Äù and should always go 1, 2, 3, 4, etc.<br>
<code>x[i]</code> is the <strong>element</strong> or value of the vector <code>x</code> at position <code>i</code> and can be any value</p>
</div>
</div>
</div>
</div>
</section>
<section id="elements-vs.-indexes-why-it-matters-1" class="slide level2 center">
<h2>Elements vs.&nbsp;Indexes: Why It Matters</h2>
<p>Let‚Äôs see what happens to our previous two codes when we save the output of them instead of just printing:</p>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="version-a">‚ùå Version A</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb12-2"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-3"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"integer"</span>, </span>
<span id="cb12-4"><a></a>                 <span class="at">length =</span> <span class="fu">length</span>(x))</span>
<span id="cb12-5"><a></a></span>
<span id="cb12-6"><a></a><span class="co"># looping over elements</span></span>
<span id="cb12-7"><a></a><span class="cf">for</span> (i <span class="cf">in</span> x) {</span>
<span id="cb12-8"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current i is:"</span>, i))</span>
<span id="cb12-9"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> i</span>
<span id="cb12-10"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current sum is:"</span>, my_sum))</span>
<span id="cb12-11"><a></a>  output[i] <span class="ot">&lt;-</span> my_sum</span>
<span id="cb12-12"><a></a>}</span>
<span id="cb12-13"><a></a></span>
<span id="cb12-14"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<h3 id="version-b">‚úÖ Version B</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb13-2"><a></a>my_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-3"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"integer"</span>, </span>
<span id="cb13-4"><a></a>                 <span class="at">length =</span> <span class="fu">length</span>(x))</span>
<span id="cb13-5"><a></a></span>
<span id="cb13-6"><a></a><span class="co"># looping over indexes</span></span>
<span id="cb13-7"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb13-8"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current i is:"</span>, i))</span>
<span id="cb13-9"><a></a>  my_sum <span class="ot">&lt;-</span> my_sum <span class="sc">+</span> x[i]</span>
<span id="cb13-10"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current sum is:"</span>, my_sum))</span>
<span id="cb13-11"><a></a>  output[i] <span class="ot">&lt;-</span> my_sum</span>
<span id="cb13-12"><a></a>}</span>
<span id="cb13-13"><a></a></span>
<span id="cb13-14"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="best-practice-loop-over-indexes" class="slide level2 center">
<h2>Best Practice: Loop Over Indexes</h2>
<p>Loop over indexes, like <code>i in 1:length(x)</code> or <code>seq_along(x)</code>, instead of elements/values. Advantages:</p>
<ul>
<li>You can modify, save, or assign values by position (e.g., <code>output[i] &lt;- ...</code>)</li>
<li>You ensure your loop works regardless of the values in the vector (e.g., if values repeat or are not valid indices)</li>
<li>You have you full control over both: the position <code>i</code> and the value at that position <code>x[i]</code></li>
</ul>
</section>
<section id="practice-fix-the-bug-in-this-for-loop" class="slide level2 center">
<h2>üíª Practice: Fix the Bug in this For Loop</h2>
<p>You are writing for loop to track <code>tomatoes</code> sold over three days. You want to add up the number of tomatoes sold and store the running total in the vector <code>output</code>.</p>
<p>But something is wrong with the code ‚Äî can you fix it? First, <em>predict</em> what the <code>output</code> vector should be, then <em>check</em> the code to find the bug.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>tomatoes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">100</span>) </span>
<span id="cb14-2"><a></a>s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-3"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"integer"</span>, <span class="at">length =</span> <span class="fu">length</span>(tomatoes))</span>
<span id="cb14-4"><a></a></span>
<span id="cb14-5"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(tomatoes)) {</span>
<span id="cb14-6"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current i is:"</span>, i))</span>
<span id="cb14-7"><a></a>  s <span class="ot">&lt;-</span> s <span class="sc">+</span> i</span>
<span id="cb14-8"><a></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Current sum is:"</span>, s))</span>
<span id="cb14-9"><a></a>  output[i] <span class="ot">&lt;-</span> s</span>
<span id="cb14-10"><a></a>}</span>
<span id="cb14-11"><a></a></span>
<span id="cb14-12"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--

::: {.cell}

```{.r .cell-code}
tomatoes <- c(10, 2, 100) 
s <- 0
output <- vector(mode = "integer", length = length(tomatoes))

for (i in seq_along(tomatoes)) {
  print(paste("Current i is:", i))
  s <- s + tomatoes[i]
  print(paste("Current sum is:", s))
  output[i] <- s
}

output
```
:::

-->
<!--

## üíª Practice

You run a store and want to keep track of how many items were sold each day: you sold 5 items in day 1, 3 items on day 2, and 7 items on day 3

```r
daily_sales <- c(5, 3, 7)
```

Your Task:

- Use a for loop to go through each day‚Äôs sales 
- For each day, print something like: "Day 2 - Items sold: 3" (the message should change accordingly)
- Create an object called `total` to store a running total of all sales
- Create an object called `ouput` to store the total after each day (e.g. `output[2]` should store the total sales after day 2)

<!--
daily_sales <- c(5, 3, 7)

total <- 0
output <- vector(mode = "integer", length = length(daily_sales))

for (i in seq_along(daily_sales)) {
  print(paste("Day", i, "- Items sold:", daily_sales[i]))
  total <- total + daily_sales[i]
  output[i] <- total
}

-->
</section>
<section id="loops-conditional-statements" class="slide level2 center">
<h2>Loops + Conditional Statements</h2>
<p>This is code from our last lecture:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb15-2"><a></a><span class="fu">ifelse</span>(numbers <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb15-3"><a></a>       <span class="st">"odd"</span>,</span>
<span id="cb15-4"><a></a>       <span class="st">"even"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can try to rewrite it using <code>if-else</code> statement, but we will get an error (recall why?):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb16-2"><a></a><span class="cf">if</span> (numbers <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>) { </span>
<span id="cb16-3"><a></a>  <span class="fu">print</span>(<span class="st">"odd"</span>)</span>
<span id="cb16-4"><a></a>} <span class="cf">else</span> {</span>
<span id="cb16-5"><a></a>  <span class="fu">print</span>(<span class="st">"even"</span>)</span>
<span id="cb16-6"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But now we know that we can fix it with a for loop!</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb17-2"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(numbers)) {</span>
<span id="cb17-3"><a></a>  <span class="cf">if</span> (numbers[i] <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb17-4"><a></a>    <span class="fu">print</span>(<span class="st">"odd"</span>)</span>
<span id="cb17-5"><a></a>  } <span class="cf">else</span> {</span>
<span id="cb17-6"><a></a>    <span class="fu">print</span>(<span class="st">"even"</span>)</span>
<span id="cb17-7"><a></a>  }</span>
<span id="cb17-8"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section>
<section id="using-for-loops-with-dataframes" class="title-slide slide level1 center middle">
<h1>4. Using For Loops with Dataframes</h1>

</section>
<section id="same-task-with-and-without-a-for-loop" class="slide level2 center">
<h2>Same Task With and Without a For Loop</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb18-2"><a></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb18-3"><a></a><span class="fu">data</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel‚Ä¶
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse‚Ä¶
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, ‚Ä¶
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, ‚Ä¶
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186‚Ä¶
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, ‚Ä¶
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male‚Ä¶
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007‚Ä¶</code></pre>
</div>
</div>
<p><br></p>
<h4 id="task-calculate-the-mean-value-of-several-columns-in-this-data">Task: Calculate the mean value of several columns in this data</h4>
<p><br></p>
</section>
<section id="calculate-the-mean-value-of-several-columns-without-a-loop" class="slide level2 center">
<h2>Calculate the mean value of several columns <em>without a loop</em></h2>
<p>We can take the <code>mean()</code> function, and apply it to each column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-2"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_bill_depth =</span> <span class="fu">mean</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-3"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_flipper_length =</span> <span class="fu">mean</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb20-4"><a></a>penguins <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_body_mass =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--
```r
mean(penguins_clean$bill_length_mm)
mean(penguins_clean$bill_depth_mm)
mean(penguins_clean$flipper_length_mm)
mean(penguins_clean$body_mass_g)
```
-->
<p>This works, but requires a lot of copy/paste! How can we do the same thing with a for loop?</p>
</section>
<section id="automate-the-same-task-with-a-loop" class="slide level2 center">
<h2>Automate the same task <em>with a loop</em></h2>
<p>First, initialize an empty vector to store the results.</p>
<p>Second, use a for loop to calculate the mean of each (numeric) column of this penguins dataframe.</p>
<p>Let‚Äôs run this code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>output <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"double"</span>, <span class="at">length =</span> <span class="fu">ncol</span>(penguins))</span>
<span id="cb21-2"><a></a></span>
<span id="cb21-3"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(penguins)) {</span>
<span id="cb21-4"><a></a>  <span class="co">#print(i)</span></span>
<span id="cb21-5"><a></a>  <span class="co">#print(penguins[i])</span></span>
<span id="cb21-6"><a></a>  output[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(penguins[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-7"><a></a>}</span>
<span id="cb21-8"><a></a></span>
<span id="cb21-9"><a></a>output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--

```r
output <- vector(mode = "double", length = ncol(penguins))

for (i in seq_along(penguins)) {
  if (is.numeric(penguins[[i]])) {
    output[i] <- mean(penguins[[i]], na.rm = TRUE)
  }
}

output
```
-->
<!-- 

### Let's unpack this example: open the **demo.Rmd** from today's class materials!

### Benefits of preallocation

This explains why we are pre-allocating in the first place, and why we do so with a vector:
having an object that is already of the same length of the output, where we are just plugging in  individual values increases speed, rather the more naive approach in which we store reuslts using an  mpty vector or an empty other object (e.g. a dataframe) of length zero, and then append or add on each of the values as we calculate them

For example, let's take this mpg data (built in dataframe in R about auto, we do not really care about the content of the data); here what we are doing is creating duplicates of that dataframe 100 times and we are then putting them together into a single data frame. 

Without preallocation: we can create an empty dataframe (here with the tibble function), iterate over 100 times, take this empty dataframe and combine the rows of it with the rows of the original dataframe, and replace the original object with the new copy and save in output (so we are appending 100 rows every time we iterate!) 

If we do proper preallocation: we create a list of 100 empty elements, every time we store the results in the list, then we use the bind_rows() functions at the end

The first approach does not preallocate by creating an empty space to store the output, the second does. See the difference in time of execution. From 80 milliseconds to less than 3. So you can see how inefficient is not to allocate since most of our data will have more than 100 rows!

.panelset[
.panel[.panel-name[Code]
```r
# no preallocation
mpg_no_preall <- tibble()
for(i in 1:100){
  mpg_no_preall <- bind_rows(mpg_no_preall, mpg)
}

# with preallocation using a list
mpg_preall <- vector(mode = "list", length = 100)
for(i in 1:100){
  mpg_preall[[i]] <- mpg
}
mpg_preall <- bind_rows(mpg_preall)
```
]

.panel[.panel-name[Plot]
```r
#| out.width = "70%",
#| echo = FALSE
# load microbenchmark library to time code
library(microbenchmark)
# bind together 100 copies of mpg
times <- microbenchmark(
  `No preallocation` = {
    mpg_no_preall <- tibble()
    
    for(i in 1:100){
      mpg_no_preall <- bind_rows(mpg_no_preall, mpg)
    }
  },
  `Preallocation` = {
    mpg_preall <- vector(mode = "list", length = 100)
    
    for(i in 1:100){
      mpg_preall[[i]] <- mpg
    }
    
    mpg_preall <- bind_rows(mpg_preall)
  }
)
autoplot(times)
```
]
]
-->
</section>
<section id="recap-what-we-learned-today" class="slide level2 center">
<h2>Recap: What We Learned Today</h2>
<ul>
<li>How for loops work and how to trace what happens at each iteration</li>
<li>How to track and save values (like running totals) during a for loop</li>
<li>Why it‚Äôs important to loop over indexes instead of elements when saving or modifying values</li>
<li>Common mistakes with loop output and how to fix them</li>
<li>Combining if-else statements with for loops</li>
<li>Using for Loops within a Dataframes (more on this next time!)</li>
</ul>
</section>
<section id="to-print-these-slides-as-pdf" class="slide level2 center">
<h2>To print these slides as pdf</h2>
<p>Click on the icon bottom-right corner &gt; Tools &gt; PDF Export Mode &gt; Print as a Pdf</p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>